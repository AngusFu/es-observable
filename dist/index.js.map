{"version":3,"file":"index.js","sources":["../lib/util.js","../lib/subscription.js","../lib/observable.js"],"sourcesContent":["const hasSymbol = typeof Symbol === 'function';\nconst toString = arg => Object.prototype.toString.call(arg);\n\nif (hasSymbol && !Symbol.observable) {\n  Symbol.observable = Symbol(\"observable\");\n}\n\nexport const observableSymbol = hasSymbol ? Symbol.observable : '@@observable';\n\nexport function isObserver(o) {\n  return o && isFunction(o.next);\n}\n\nexport function isObservable(o) {\n  return o && isFunction(o[observableSymbol]);\n}\n\nexport function isFunction(f) {\n  return toString(f) === '[object Function]';\n}\n","import {\n  isFunction\n} from './util';\n\nexport default class Subscription {\n  constructor(observer, subscriber) {\n    if (!observer) {\n      throw 'invali oberserver';\n    }\n\n    this.observer = observer;\n    this._closed = false;\n    \n    subscriber({\n      next: val => {\n        if (!this._closed && isFunction(observer.next)) {\n          observer.next && observer.next(val);\n        }\n      },\n      error: err => {\n        if (!this._closed && isFunction(observer.error)) {\n          observer.error && observer.error(err);\n        }\n      },\n      complete: () => {\n        if (!this._closed && isFunction(observer.complete)) {\n          observer.complete && observer.complete();\n        }\n      }\n    });\n  }\n\n  unsubscribe() {\n    this._closed = true;\n    this.observer = null;\n  }\n\n  get closed() {\n    return this._closed;\n  }\n}\n","import {\n  observableSymbol,\n  isFunction\n} from './util';\nimport Subscription from './subscription';\n\nexport default class Observable {\n  constructor(subscriber) {\n    if (!isFunction(subscriber)) {\n      throw 'subscriber is not a function';\n    }\n    \n    this.subscriber = subscriber;\n  }\n\n  [observableSymbol]() {\n    return this;\n  }\n\n  subscribe(observer, ...args) {\n    if (isFunction(observer)) {\n      observer = {\n        next: observer,\n        error: args[0],\n        complete: args[1]\n      };\n    }\n\n    return new Subscription(observer, this.subscriber);\n  }\n}\n\n\nfunction listen(element, eventName) {\n    return new Observable(observer => {\n        // Create an event handler which sends data to the sink\n        let handler = event => observer.next(event);\n\n        // Attach the event handler\n        element.addEventListener(eventName, handler, true);\n\n        // Return a cleanup function which will cancel the event stream\n        return () => {\n            // Detach the event handler from the element\n            element.removeEventListener(eventName, handler, true);\n        };\n    });\n}\n\nconst s = listen(document, 'click');\nwindow.s = s.subscribe((e) => console.log(e));"],"names":["const","this","let"],"mappings":"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"}